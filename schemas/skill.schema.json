{
	"$schema": "http://json-schema.org/draft-07/schema#",
	"title": "AdaOS Skill",
	"type": "object",
	"additionalProperties": false,
	"properties": {
		"name": { "type": "string", "pattern": "^[a-z0-9_.-]+$" },
		"version": {
			"type": "string",
			"pattern": "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:[-+][0-9A-Za-z.-]+)?$"
		},
		"description": { "type": "string" },

		"author": { "type": "string" },
		"license": { "type": "string" },
		"homepage": { "type": "string", "format": "uri" },
		"repository": { "type": "string" },

		"runtime": {
			"description": "требуемые рантаймы/их версии",
			"type": "object",
			"minProperties": 1,
			"additionalProperties": false,
			"properties": {
				"python": { "type": "string" },
				"node": { "type": "string" },
				"deno": { "type": "string" },
				"bash": { "type": "string" }
			}
		},

		"entry": {
			"description": "как исполнить навык (опционально, если есть договорённости по умолчанию)",
			"type": "object",
			"additionalProperties": false,
			"properties": {
				"module": { "type": "string" },
				"callable": { "type": "string" },
				"script": { "type": "string" },
				"args": {
					"type": "array",
					"items": { "type": "string" }
				}
			}
		},

		"dependencies": {
			"description": "список зависимостей (строки, как в менеджере пакетов)",
			"type": "array",
			"items": { "type": "string", "minLength": 1 }
		},

		"env": {
			"description": "переменные окружения по умолчанию",
			"type": "object",
			"additionalProperties": { "type": "string" }
		},

		"permissions": {
			"description": "запрашиваемые разрешения песочницы",
			"type": "array",
			"uniqueItems": true,
			"items": {
				"type": "string",
				"enum": [
					"network",
					"filesystem",
					"microphone",
					"speaker",
					"camera",
					"process",
					"gpu"
				]
			}
		},

		"events": {
			"type": "object",
			"additionalProperties": false,
			"properties": {
				"subscribe": {
					"type": "array",
					"items": { "$ref": "#/$defs/topic" }
				},
				"publish": {
					"type": "array",
					"items": { "$ref": "#/$defs/topic" }
				}
			}
		},

		"tools": {
			"description": "инструменты (callables), доступные сценарию / другим навыкам",
			"type": "array",
			"minItems": 1,
			"items": { "$ref": "#/$defs/tool" }
		}
	},
	"required": ["name", "version"],

	"$defs": {
		"topic": {
			"type": "string",
			"pattern": "^[A-Za-z0-9_]+(\\.[A-Za-z0-9_]+)*$"
		},

		"jsonSchema": {
			"description": "вложенная JSON Schema для проверки входов/выходов",
			"oneOf": [{ "type": "boolean" }, { "type": "object" }]
		},

		"tool": {
			"type": "object",
			"additionalProperties": false,
			"properties": {
				"name": { "type": "string", "pattern": "^[A-Za-z_][A-Za-z0-9_]*$" },
				"description": { "type": "string" },
				"input_schema": { "$ref": "#/$defs/jsonSchema" },
				"output_schema": { "$ref": "#/$defs/jsonSchema" }
			},
			"required": ["name"]
		}
	}
}
